{{{#!comment
    YangVillage Website
    Copyright (C) 2024  Qzlzdy

    This content is licensed under the Creative Commons Attribution Share Alike
    4.0 International (CC-BY-SA-4.0).

    See <https://creativecommons.org/licenses/by-sa/4.0/>.
}}}
= 1. Ypologisti工程

[[PageOutline(1-3)]]

Ypologosti工程是一个在[https://www.minecraft.net/zh-hans Minecraft]中建造红石计算机的工程。该工程包括从计算机硬件结构、操作系统到用户软件的全套实现。这个工程的产生源自村长对这款游戏的热爱。同时，通过这项工程，村长也可以从中深入学习到现代数字计算机的运行原理。

== 1.1. 工程要实现什么

要在Minecraft中建造并运行一台红石计算机，以下子项目是不可或缺的：

- 硬件系统
- 操作系统
- 应用程序

上述子项目只是一个大分类，其中还包含诸多子工程。这些工程大部分都基于现存的某个开源项目实现，但都对项目实现做了大量修改，目的是删除无关部分；加快红石计算机的运行速度；减少红石计算机存储空间需求。在各个子工程的独立页面将会有更详细的介绍。

=== 1.1.1. 硬件系统

直接放置于世界中的部分，是软件系统的载体。要实现硬件系统，首先需要确定计算机使用的指令集架构。考虑到对指令译码器以及数据通路部分的实现难度，精简指令集计算机是更好的。因此，工程选择[https://riscv.org/specifications/ratified/ RISC-V]指令集作为基础。

> MIPS也是一个不错的选择，但是该指令集已经事实上的停止维护了~~已经变成[https://www.loongson.cn/ loongson]的形状了~~。

为了取得在系统实现复杂度和系统运行速度之间的平衡，工程对于RISC-V ISA的硬件实现有如下要求：

- 使用流水线，但不使用超流水线和超标量。
- 指令顺序流出，顺序执行。
- 通过旁路和空泡消除流水线冒险。
- 只有L1级Cache，且为哈佛结构；内存为冯·诺伊曼结构。

综合考虑以上条件，工程选择[https://github.com/ucb-bar/riscv-mini.git ucb-bar/riscv-mini]项目为基础。由于riscv-mini不包含Cache，因此Cache的实现选择了[https://github.com/OpenXiangShan/XiangShan.git OpenXiangShan/XiangShan]项目为基础。Cache使用的通信协议则基于[https://www.sifive.com/document-file/tilelink-spec-1.9.3 TileLink]。

> 红石计算机体积大，运算慢，实际上使用8位的指令集也许是更好的选择，但是村长认为选择32位指令集能够更好地学习现代计算机运行原理。

> 如果不考虑实现复杂度，XiangShan是一个不错的选择。他们甚至把一大坨扩展都实现了。

==== 相关页面

- [./MesyIsa mesy指令集架构]
- [./MesyPriv mesy特权指令集架构]
- [./SyndeProtocol syndesmos协议]
- [./YlikouArch ylikou处理器]

=== 1.1.2. 操作系统

操作系统是软硬件的分界线，向上提供应用程序接口，向下管理所有硬件资源。现存的操作系统御三家中，选择基于Linux的发行版作为工程的基础是一个理所当然的决定。但在众多的Linux发行版中选择合适的操作系统是一个难题。工程最终选择的是[https://www.linuxfromscratch.org/lfs/read.html Linux From Scratch (LFS)]~~这真的可以叫发行版吗~~。理由是：

- 极端自定义。这对于存储空间有限，面向特定任务的红石计算机来说非常合适。
- 详细的文档。LFS文档已经把一个完整的操作系统拆解成内核和其他程序。因此工程可以对不同的部分选择不同的项目作为基础。

==== 相关页面

[./SystimaOs systima操作系统]

=== 1.1.3. 应用程序

应用程序部分目前还没有完整的计划，但部分核心组件已经完成了设计。以下是所有应用程序工程的独立页面：

==== 相关页面

[./ErgaToolchain erga编译工具链]
